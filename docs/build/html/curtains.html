
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>curtains &#8212; smtools 0.3.0 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Stacks Module" href="stacks.html" />
    <link rel="prev" title="Alignment" href="alignment.html" /> 
  </head>
  <body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">smtools 0.3.0 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="alignment.html" title="Alignment"
             accesskey="P">previous</a> |
          <a href="stacks.html" title="Stacks Module"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="curtains">
<h1>curtains<a class="headerlink" href="#curtains" title="Permalink to this headline">¶</a></h1>
<div class="section" id="detecting-dna-curtains">
<h2>Detecting DNA curtains<a class="headerlink" href="#detecting-dna-curtains" title="Permalink to this headline">¶</a></h2>
<p>The <cite>smtools.curtains</cite> module is designed to locate, and fit the intensity
profile of individual DNA molecules within a DNA curtain. For a description
of how it works see our walkthroughs <a class="reference external" href="https://github.com/ReddingLab/Learning/blob/master/image-analysis-basics/5__DNA_curtain_finder_1.ipynb">part 1</a>, <a class="reference external" href="https://github.com/ReddingLab/Learning/blob/master/image-analysis-basics/6__DNA_curtain_finder_2.ipynb">part 2</a>, and <a class="reference external" href="https://github.com/ReddingLab/Learning/blob/master/image-analysis-basics/7__DNA_curtain_finder_3.ipynb">part 3</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">smtools.curtains</span> <span class="kn">as</span> <span class="nn">cs</span>
<span class="kn">import</span> <span class="nn">smtools.alignment</span> <span class="kn">as</span> <span class="nn">al</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="kn">import</span> <span class="n">rotate</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">smtools.testdata</span> <span class="kn">as</span> <span class="nn">test</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">test_curtain</span><span class="p">()</span>
<span class="n">ch1</span><span class="p">,</span><span class="n">ch2</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">im_split</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="n">angle</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_rotang</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
<span class="n">rotated_ch2</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span><span class="n">angle</span><span class="p">)</span>
<span class="n">bounds</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_curtain</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="n">strands</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span><span class="n">bounds</span><span class="p">)</span>
<span class="n">DNAs</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">fit_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span> <span class="n">strands</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">DNAs</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">],[</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="s2">&quot;r.&quot;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/curtain_finder.png"><img alt="_images/curtain_finder.png" src="_images/curtain_finder.png" style="width: 800px;" /></a>
</div>
<div class="section" id="module-curtains">
<span id="the-curtains-module"></span><h2>The curtains module<a class="headerlink" href="#module-curtains" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="curtains.find_rotang">
<code class="descclassname">curtains.</code><code class="descname">find_rotang</code><span class="sig-paren">(</span><em>Image</em>, <em>line_length=40</em>, <em>theta=None</em>, <em>line_gap=5</em>, <em>tilt=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.find_rotang" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the general rotation of an image containing DNA curtains.
Uses a
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
to approximate DNA locations. Returns the average angle of all
hough lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Image</strong> – 2D image array</li>
<li><strong>line_length</strong> – <p>int, minimum accepted length of line detected
by the <a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
Default is 40.</p>
</li>
<li><strong>theta</strong> – <p>array, angles at which to compute the
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
in radians. Default is None</p>
</li>
<li><strong>line_gap</strong> – int, maximum gap between pixels allowed when
forming a line. default is 5</li>
<li><strong>tilt</strong> – <p>int, when theta is None, the tilt value defines the
range of thetas to be used in the
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
as (pi/2 - tilt:pi/2 + tilt). Defaults to 0.1 radians</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">measure rotation angle in radians:</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.curtain</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.testdata</span> <span class="k">as</span> <span class="nn">test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">test_curtain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ch1</span><span class="p">,</span><span class="n">ch2</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">im_split</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="o">.</span><span class="n">find_rotang</span><span class="p">(</span><span class="n">ch2</span><span class="p">))</span>
<span class="go">0.6936316728744394</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="curtains.find_curtain">
<code class="descclassname">curtains.</code><code class="descname">find_curtain</code><span class="sig-paren">(</span><em>Image</em>, <em>distance=50</em>, <em>line_length=40</em>, <em>theta=None</em>, <em>line_gap=5</em>, <em>tilt=0.1</em>, <em>window=15</em>, <em>order=3</em>, <em>maxline=70</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.find_curtain" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Image</strong> – 2D image array</li>
<li><strong>distance</strong> – int, passes to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html">peak_finder</a>.
defines minimum spacing between two separate curtains.
Default is 50.</li>
<li><strong>line_length</strong> – <p>int, minimum accepted length of line detected
by the <a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
Default is 40.</p>
</li>
<li><strong>theta</strong> – <p>array, angles at which to compute the
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
in radians. Default is None</p>
</li>
<li><strong>line_gap</strong> – int, maximum gap between pixels allowed when
forming a line. default is 5</li>
<li><strong>tilt</strong> – <p>int, when theta is None, the tilt value defines the
range of thetas to be used in the
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>
as (pi/2 - tilt:pi/2 + tilt). Defaults to 0.1 radians</p>
</li>
<li><strong>window</strong> – int, window value passed to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.signal.savgol_filter.html">savgol_filter</a></li>
<li><strong>order</strong> – <p>int, order value passed to the
<a class="reference external" href="https://docs.scipy.org/doc/scipy-0.15.1/reference/generated/scipy.signal.savgol_filter.html">savgol_filter</a></p>
</li>
<li><strong>maxline</strong> – <p>int, maximum size line detected by the
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.probabilistic_hough_line">Hough line Transform</a>.
defaults to 70.</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of tuples containing (x_min, x_max, y_min, y_max)
for each curtain in the image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Boolean mask of the image. Evaluates True within the
bounds of the detected curtains, and False outside.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.curtain</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.testdata</span> <span class="k">as</span> <span class="nn">test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="k">import</span> <span class="n">rotate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">test_curtain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ch1</span><span class="p">,</span><span class="n">ch2</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">im_split</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_rotang</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_ch2</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span><span class="n">angle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_curtain</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
<span class="go">[(1, 76, 0, 515), (89, 157, 0, 513), (167, 235, 0, 515)]</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="curtains.find_DNA">
<code class="descclassname">curtains.</code><code class="descname">find_DNA</code><span class="sig-paren">(</span><em>Image</em>, <em>Bounds</em>, <em>prominence=None</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.find_DNA" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Image</strong> – 2D image array</li>
<li><strong>Bounds</strong> – 1D List of tuples containing
(x_min, x_max, y_min, y_max) for each curtain in the image.
written to accept output from toolbox.curtains.find_curtain</li>
<li><strong>prominence</strong> – <p>passes to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.find_peaks.html">peak_finder</a>
Defaults to (20, 1.5 * max(array)</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of tuples: (top, bottom, and center). Locations of
each DNA strand detected in pixels.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.curtain</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.testdata</span> <span class="k">as</span> <span class="nn">test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="k">import</span> <span class="n">rotate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">test_curtain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ch1</span><span class="p">,</span><span class="n">ch2</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">im_split</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_rotang</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_ch2</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span><span class="n">angle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_curtain</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span><span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">strands</span><span class="p">))</span>
<span class="go">269</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="curtains.fit_DNA">
<code class="descclassname">curtains.</code><code class="descname">fit_DNA</code><span class="sig-paren">(</span><em>Image</em>, <em>locations</em>, <em>constraints=None</em>, <em>init_guess_length=None</em>, <em>init_guess_center=None</em>, <em>pad=2</em>, <em>factor=1.3</em>, <em>min_length=45</em>, <em>cen_err=0.3</em>, <em>cen_dev=3.0</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.fit_DNA" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Image</strong> – 2D image array</li>
<li><strong>locations</strong> – 1List of tuples: (top, bottom, and center).
Locations of each DNA strand detected in pixels.
written to accept output from toolbox.curtains.find_DNA</li>
<li><strong>constraints</strong> – 1D list, size 5. bounds on the call to
curve_fit when fitting toolbox.misc.super_gauss_function. see
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">bounds</a>
Default is ([0, 0, 0, 0, 5.],[np.inf, np.inf, np.inf, np.inf, np.inf]).</li>
<li><strong>init_guess_length</strong> – 1D list, size 5. initial guess for the
parameters for the call to curve_fit when fitting
toolbox.misc.super_gauss_function. see
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">p0</a>
Default is [.2, 1., np.median(xdata), 20, 6].</li>
<li><strong>init_guess_center</strong> – <p>1D list, size 5. initial guess for the
parameters for the call to curve_fit when fitting
toolbox.misc.mundane_gauss_function. see
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">p0</a>
Default is [1, 1, 2, 1].</p>
</li>
<li><strong>pad</strong> – int, number of adjacent rows of pixels to grab for
the fit, Default is 2 pixels out on each side.</li>
<li><strong>factor</strong> – float, multiplier used in end detection. defines
the intensity threshold at the ends as
maximum - ((maximum - minimum)/factor)</li>
<li><strong>min_length</strong> – int, minimum allowed length of DNA.
Default is 45.</li>
<li><strong>cen_err</strong> – float, maximum error ratio on the mean for the
call to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">curve_fit</a>
when fitting toolbox.misc.mundane_gauss_function.
Defined as np.sqrt(pcov[2][2])/popt[2]
Defualts to 0.3.</li>
<li><strong>cen_dev</strong> – <p>float, maximum allowed standard deviation for the
call to
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">curve_fit</a>
when fitting toolbox.misc.mundane_gauss_function.
Defualts to 3.</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of tuples: (top, bottom, and center). Locations of
each DNA strand detected as defined by the fitting with
toolbox.misc.super_gauss_function and
toolbox.misc.mundane_gauss_function.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Example:</th><td class="field-body"><div class="first last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.curtain</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.testdata</span> <span class="k">as</span> <span class="nn">test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="k">import</span> <span class="n">rotate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">test_curtain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ch1</span><span class="p">,</span><span class="n">ch2</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">im_split</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_rotang</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_ch2</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span><span class="n">angle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_curtain</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span><span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DNAs</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">fit_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span> <span class="n">strands</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DNAs</span><span class="p">))</span>
<span class="go">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">DNAs</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">],[</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="s2">&quot;r.&quot;</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="curtains.Curtain">
<em class="property">class </em><code class="descclassname">curtains.</code><code class="descname">Curtain</code><span class="sig-paren">(</span><em>DNA</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.Curtain" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection into a Curtain .</p>
<dl class="docutils">
<dt>DNA <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-obj docutils literal"><span class="pre">list</span></code></span></dt>
<dd>Accepts output from <cite>fit DNA</cite></dd>
<dt>points <span class="classifier-delimiter">:</span> <span class="classifier"><code class="xref py py-obj docutils literal"><span class="pre">list</span></code> or <code class="xref py py-obj docutils literal"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">tuples</span></code></span></dt>
<dd>points to apply to DNA</dd>
</dl>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.curtain</span> <span class="k">as</span> <span class="nn">cs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">smtools.testdata</span> <span class="k">as</span> <span class="nn">test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage.interpolation</span> <span class="k">import</span> <span class="n">rotate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">im</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">test_curtain</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ch1</span><span class="p">,</span><span class="n">ch2</span> <span class="o">=</span> <span class="n">al</span><span class="o">.</span><span class="n">im_split</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_rotang</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_ch2</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">ch2</span><span class="p">,</span><span class="n">angle</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_curtain</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">find_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span><span class="n">bounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DNAs</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">fit_DNA</span><span class="p">(</span><span class="n">rotated_ch2</span><span class="p">,</span> <span class="n">strands</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span> <span class="o">=</span> <span class="n">Curtain</span><span class="p">(</span><span class="n">DNAs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strands</span><span class="o">.</span><span class="n">assign_points</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">test_points</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">strands</span><span class="o">.</span><span class="n">get_DNA</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="curtains.Curtain.add_point">
<code class="descname">add_point</code><span class="sig-paren">(</span><em>key</em>, <em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.Curtain.add_point" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> – keys to DNA_dictionary</li>
<li><strong>point</strong> – (x,y)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="curtains.Curtain.assign_points">
<code class="descname">assign_points</code><span class="sig-paren">(</span><em>points</em>, <em>frame=None</em>, <em>pad=5</em>, <em>max_offset=1</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.Curtain.assign_points" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>points</strong> – 1D list of (x,y) points</li>
<li><strong>frame</strong> – frame number if data are from image stack</li>
<li><strong>pad</strong> – additional extension to length of DNA applied to
top and bottom position when assigning points.</li>
<li><strong>max_offset</strong> – maximum distance from center of DNA strand
that still allows a point to be assigned to it.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="curtains.Curtain.assign_point_stack">
<code class="descname">assign_point_stack</code><span class="sig-paren">(</span><em>points_list</em>, <em>pad=5</em>, <em>max_offset=1</em><span class="sig-paren">)</span><a class="headerlink" href="#curtains.Curtain.assign_point_stack" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>points_list</strong> – list of 1D lists of (x,y) points</li>
<li><strong>pad</strong> – additional extension to length of DNA applied to
top and bottom position when assigning points.</li>
<li><strong>max_offset</strong> – max_offset: maximum distance from center of DNA strand
that still allows a point to be assigned to it.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="curtains.Curtain.get_DNA">
<code class="descname">get_DNA</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#curtains.Curtain.get_DNA" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict, Keys are (top, bottom, center) for each DNA
strand. Entries are lists of points (x, y) or (x, y, frame)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <p class="caption"><span class="caption-text">PACKAGE CONTENTS:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="point_fitting.html">point_fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="alignment.html">Alignment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">curtains</a></li>
<li class="toctree-l1"><a class="reference internal" href="stacks.html">Stacks Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc_module.html">Misc Module</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="alignment.html" title="Alignment"
              >previous</a> |
            <a href="stacks.html" title="Stacks Module"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/curtains.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Redding Lab, UCSF.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>